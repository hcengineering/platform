# Min override: excludes optional services from min deployment.
# Use with: docker compose -f docker-compose.yaml -f docker-compose.min.yaml up
# (rush docker:up:min)
# Excluded: preview, link-preview, elastic, redis, stats, payment, fulltext_cockroach,
#           print, sign, hulykvs, hulygun, hulypulse, process-service, backup-cockroach,
#           backup-api, rating_cockroach
# Overrides below remove dependencies on excluded services so the min project validates.

services:
  preview:
    profiles: ["full"]
  link-preview:
    profiles: ["full"]
  elastic:
    profiles: ["full"]
  redis:
    profiles: ["full"]
  stats:
    profiles: ["full"]
  payment:
    profiles: ["full"]
  fulltext_cockroach:
    profiles: ["full"]
  print:
    profiles: ["full"]
  sign:
    profiles: ["full"]
  hulykvs:
    profiles: ["full"]
  hulygun:
    profiles: ["full"]
  hulypulse:
    profiles: ["full"]
  process-service:
    profiles: ["full"]
  backup-cockroach:
    profiles: ["full"]
  backup-api:
    profiles: ["full"]
  rating_cockroach:
    profiles: ["full"]
  account:
    links: !override []
  workspace_cockroach:
    links: !override
      - cockroach
      - minio
  collaborator:
    links: !override
      - minio
      - transactor_cockroach
  front:
    links: !override []
  transactor_cockroach:
    links: !override
      - cockroach
      - minio
      - account
  export:
    links: !override
      - minio
  datalake:
    depends_on: !override
      minio:
        condition: service_healthy
      cockroach:
        condition: service_started
      account:
        condition: service_started
